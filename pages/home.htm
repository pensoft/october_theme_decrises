url = "/"
layout = "default"
title = "DeCrises"
is_hidden = 0
meta_description = "The DeCrises project"
robot_index = "index"
robot_follow = "follow"

[jumbotron vision]
jumbotron = "vision"
background = "transperant"
templates = "template3"
description_limit = 0

[jumbotron mission]
jumbotron = "mission"
background = "transperant"
templates = "template3"
description_limit = 0
==
<?php
use Pensoft\Articles\Models\Article;
use Pensoft\Calendar\Models\Entry;
use Carbon\Carbon;


function onStart(){

    $this['entries'] = Entry::where('end', '>', Carbon::now())->where('show_on_timeline', true)->where('is_internal', false)->orderBy('start', 'asc')->take(3)->get();

    $this['highlights'] = Article::news()->where('published', 'true')->descPublished()->take(3)->get()->map(function($item){
        $item->content = str_limit(strip_tags($item->content), 90);
        $item->href = $item->slug;
        return $item;
    });
}
?>
==
<!-- Vision Section -->
<section class="container vision" role="region" aria-labelledby="vision-heading">
    <div class="row between-md around-xs">
        <div class="col-md-7 col-xs-12">
            <h2 id="vision-heading" class="sr-only">{{'Our Vision'|_}}</h2>
            {% component 'vision' %}
            <a href="/{{currentLang}}/about" class="btn-primary" aria-label="Learn more about our vision">{{'Learn more'|_}}</a>
        </div>
        <div class="col-md-5 col-xs-12 end-md center-xs" data-aos="fade-up">
            <img src="{{'vision.png'|media}}" alt="Illustration representing our vision for multilevel governance and equitable transitions" role="img">
        </div>
    </div>
</section>

<!-- Mission Section -->
<section class="container mission" role="region" aria-labelledby="mission-heading">
    <div class="row between-md around-xs middle-xs">
        <div class="col-md-5 col-xs-12 start-md center-xs" data-aos="fade-up">
            <img src="{{'mission.png'|media}}" alt="Illustration representing our mission to explore social innovations" role="img">
        </div>
        <div class="col-md-7 col-xs-12">
            <h2 id="mission-heading" class="sr-only">{{'Our Mission'|_}}</h2>
            {% component 'mission' %}
            <a href="/{{currentLang}}/about" class="btn-primary" aria-label="Learn more about us and our mission">{{'About us'|_}}</a>
        </div>
    </div>
</section>

<!-- Latest News Section -->
{% if highlights.count %}
<section class="latest-news-container" role="region" aria-labelledby="news-heading">
    <div class="container mb-0 pb-0">
        <div class="row nav-row">
            <div class="col-md-9 col-xs-12">
                <h2 id="news-heading">{{'Latest news'|_}}</h2>
            </div>
            <div class="col-md-3 col-xs-12 view-all-button">
                <a href="{{'news'|page}}" class="btn btn-primary" aria-label="View all news articles">{{'View all news'|_}}</a>
            </div>
        </div>
    </div>

    <div class="container home-container">
        <div class="row highligts-row">
            <div class="col-md-8 col-xs-12 latest-news">
                {% if highlights|length %}
                <article class="news-card" role="article" aria-labelledby="featured-article-title">
                    <div class="img-container">
                        <a href="{{'news'|page}}/{{highlights[0].slug}}" aria-label="Read full article: {{ highlights[0].title|striptags }}">
                            <img src="{{ highlights[0].cover.path }}"
                                 alt="Featured image for article: {{ highlights[0].title|striptags }}"
                                 role="img">
                        </a>

                        <div class="news-content news-title">
                            <time class="news-date" datetime="{{ highlights[0].published_at|date('Y-m-d') }}" aria-label="Published on {{ highlights[0].published_at|date('d F Y') }}">
                                {{highlights[0].published_at|date("d")}} {{highlights[0].published_at|date("F")|upper|_}} {{highlights[0].published_at|date("Y")}}
                            </time>
                            <h3 id="featured-article-title" class="title">
                                <a href="{{'news'|page}}/{{highlights[0].slug}}" aria-describedby="featured-article-date">
                                    {{ highlights[0].title|length > 70 ? highlights[0].title|striptags|slice(0, 70)|replace({"&nbsp;": " ", ".": ". "}) ~ '...' : highlights[0].title|striptags|replace({"&nbsp;": " ", ".": ". "}) }}
                                </a>
                            </h3>
                        </div>
                    </div>
                </article>
                {% endif %}
            </div>

            <aside class="col-md-4 col-xs-12 highlight-news" role="complementary" aria-label="Additional news articles">
                <h3 class="sr-only">{{'More recent articles'|_}}</h3>
                {% for article in highlights|slice(1, 2) %}
                <article class="row news-card" role="article" aria-labelledby="article-title-{{loop.index}}">
                    <div class="img-container">
                        <a href="{{'news'|page}}/{{article.slug}}" aria-label="Read full article: {{ article.title|striptags }}">
                            <img src="{{ article.cover.path }}"
                                 alt="Image for article: {{ article.title|striptags }}"
                                 role="img">
                        </a>

                        <div class="news-content news-title">
                            <time class="news-date" datetime="{{ article.published_at|date('Y-m-d') }}" aria-label="Published on {{ article.published_at|date('d F Y') }}">
                                {{article.published_at|date("d")}} {{article.published_at|date("F")|upper|_}} {{article.published_at|date("Y")}}
                            </time>
                            <h4 id="article-title-{{loop.index}}" class="title">
                                <a href="{{'news'|page}}/{{article.slug}}" aria-describedby="article-date-{{loop.index}}">
                                    {{ article.title|length > 70 ? article.title|striptags|slice(0, 70)|replace({"&nbsp;": " ", ".": ". "}) ~ '...' : article.title|striptags|replace({"&nbsp;": " ", ".": ". "}) }}
                                </a>
                            </h4>
                        </div>
                    </div>
                </article>
                {% endfor %}
            </aside>
        </div>
    </div>
</section>
{% endif %}
